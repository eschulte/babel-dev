---
title: DONE document configuration changes for Babel integration
layout: default
---

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="done DONE"> DONE</span> document configuration changes for Babel integration </h2>
<div class="outline-text-2" id="text-1">

<ul>
<li>
State "DONE"       from "" <span class="timestamp-wrapper"> <span class="timestamp">2010-07-05 Mon 11:03</span></span>
</li>
</ul>

<p>Babel took the integration into Org-mode as an opportunity to do
some much needed house cleaning.  Most importantly we have
simplified the enabling of language support, and cleared out
unnecessary configuration variables &ndash; which is great unless you
already have a working configuration under the old model.
</p>
<p>
The most important changes regard the <i>location</i> and <i>enabling</i>
of Babel (both core functionality and language specific support).
</p>
<dl>
<dt>Babel</dt><dd>
Babel is now part of the core of Org-mode, so it is
now loaded along with the rest of Org-mode.  That means that
there is <i>no configuration</i> required to enable the main
Babel functionality.  For current users, this means that
statements like



<pre class="src src-emacs-lisp"><span class="org-esk-paren">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-babel</span><span class="org-esk-paren">)</span>
</pre>


<p>
or
</p>


<pre class="src src-emacs-lisp"><span class="org-esk-paren">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-babel-init</span><span class="org-esk-paren">)</span>
</pre>


<p>
that may by lying around in your configuration must now be
removed.
</p></dd>
<dt>load path</dt><dd>
Babel (including all language specific files --
aside from those which are located in the <code>contrib/</code>
directory for reasons of licencing) now lives in the base of
the Org-mode lisp directory, so <i>no additional directories</i>
need to be added to your load path to use babel.  For Babel
users this means that statements adding babel-specific
directories to your load-path should now be removed from
your config.
</dd>
<dt>language support</dt><dd>
It is no longer necessary to require
language specific support on a language-by-language basis.
Specific language support should now be managed through the
`org-babel-load-languages' variable.  This variable can be
customized using the Emacs customization interface, or
through the addition of something like the following to your
configuration (note: any language not mentioned will <i>not</i>
be enabled, aside from <code>emacs-lisp</code> which is enabled by
default)



<pre class="src src-emacs-lisp"><span class="org-esk-paren">(</span>org-babel-do-load-languages
 'org-babel-load-languages
 '<span class="org-esk-paren">((</span>R . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>ditaa . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>dot . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>emacs-lisp . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>gnuplot . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>haskell . nil<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>ocaml . nil<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>python . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>ruby . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>screen . nil<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>sh . t<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>sql . nil<span class="org-esk-paren">)</span>
   <span class="org-esk-paren">(</span>sqlite . t<span class="org-esk-paren">)))</span>
</pre>



<p>
Despite this change it is still possible to add
language support through the use of <code>require</code>
statements, however to conform to Emacs file-name
regulations all Babel language files have changed
prefix from <code>org-babel-*</code> to <code>ob-*</code>, so the require
lines must also change e.g.
</p>


<pre class="src src-emacs-lisp"><span class="org-esk-paren">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-babel-R</span><span class="org-esk-paren">)</span>
</pre>


<p>
should be changed to
</p>


<pre class="src src-emacs-lisp"><span class="org-esk-paren">(</span><span class="org-keyword">require</span> '<span class="org-constant">ob-R</span><span class="org-esk-paren">)</span>
</pre>



</dd>
</dl>

<p>We have eliminated the <code>org-babel-tangle-w-comments</code> variable as
well as the two main internal lists of languages, namely
</p><ul>
<li>
<code>org-babel-interpreters</code> and
</li>
<li>
<code>org-babel-tangle-langs</code> 

</li>
</ul>

<p>so any config lines which mention those variables, can/should be
stripped out in their entirety.  This includes any calls to the
<code>org-babl-add-interpreter</code> function, whose sole purpose was to
add languages to the <code>org-babel-interpreters</code> variable.
</p>
<p>
With those calls stripped out, we may still in some cases want to
associate a file name extension with certain languages, for
example we want all of our emacs-lisp files to end in a <code>.el</code>, we
can do this will the <code>org-babel-tangle-lang-exts</code> variable.  In
general you shouldn't need to touch this as it already has
defaults for most common languages, and if a language is not
present in org-babel-tangle-langs, then babel will just use the
language name, so for example a file of <code>c</code> code will have a <code>.c</code>
extension by default, shell-scripts (identified with <code>sh</code>) will
have a <code>.sh</code> extension etc&hellip;
</p>
<p>
The configuration of <i>shebang</i> lines now lives in header
arguments.  So the shebang for a single file can be set at the
code block level, e.g.
</p>



<pre class="src src-org"><span class="org-org-meta-line">#+begin_src clojure :shebang #!/usr/bin/env clj
</span><span class="org-org-block">  (println "with a shebang line, I can be run as a script!")</span><span class="org-org-meta-line">
#+end_src  </span>
</pre>



<p>
Note that whenever a file is tangled which includes a <i>shebang</i>
line, Babel will make the file executable, so there is good
reason to only add <i>shebangs</i> at the source-code block level.
However if you're sure that you want all of your code in some
language (say shell scripts) to tangle out with shebang lines,
then you can customize the default header arguments for that
language, e.g.
</p>



<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">ensure this variable is defined defined
</span><span class="org-esk-paren">(</span><span class="org-keyword">unless</span> <span class="org-esk-paren">(</span>boundp 'org-babel-default-header-args:sh<span class="org-esk-paren">)</span>
  <span class="org-esk-paren">(</span>setq org-babel-default-header-args:sh '<span class="org-esk-paren">()))</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">add a default shebang header argument
</span><span class="org-esk-paren">(</span>add-to-list 'org-babel-default-header-args:sh
             '<span class="org-esk-paren">(</span><span class="org-builtin">:shebang</span> . <span class="org-string">"#!/bin/bash"</span><span class="org-esk-paren">))</span>  
</pre>



<p>
The final important change included in this release is the
addition of new security measures into Babel.  These measures are
in place to protect users from the accidental or uninformed
execution of code.  Along these lines <i>every</i> execution of a code
block will now require an explicit confirmation from the user.
These confirmations can be stifled through customization of the
`org-confirm-babel-evaluate' variable, e.g.
</p>


<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">I don't want to be prompted on every code block evaluation
</span><span class="org-esk-paren">(</span>setq org-confirm-babel-evaluate nil<span class="org-esk-paren">)</span>
</pre>



<p>
In addition, it is now possible to remove code block evaluation
form the <code>C-c C-c</code> keybinding.  This can be done by setting the
<code>org-babel-no-eval-on-ctrl-c-ctrl-c</code> variable to a non-nil value,
e.g.
</p>


<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">I don't want to execute code blocks with C-c C-c
</span><span class="org-esk-paren">(</span>setq org-babel-no-eval-on-ctrl-c-ctrl-c t<span class="org-esk-paren">)</span>
</pre>



<p>
An additional keybinding has been added for code block
evaluation, namely <code>C-c C-v e</code>.
</p>
<p>
Whew! that seems like a lot of effort for a <i>simplification</i> of
configuration.
</p></div>
</div>
