---
title: DONE results deletion and insertion
layout: default
---

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="done DONE"> DONE</span> results deletion and insertion </h2>
<div class="outline-text-2" id="text-1">

<ul>
<li>
State "DONE"       from "PROPOSED" <span class="timestamp-wrapper"> <span class="timestamp">2010-06-07 Mon 16:46</span></span>
</li>
<li>
State "PROPOSED"   from "" <span class="timestamp-wrapper"> <span class="timestamp">2010-03-09 Tue 09:33</span></span>

</li>
</ul>

<p>Graham's problem was that on C-c C-c, this
</p>



<pre class="src src-org"><span class="org-org-meta-line">#+ATTR_LaTeX: width=10cm</span>
<span class="org-org-meta-line">#+results: BoxplotFlowering</span>
<span class="org-org-link">file:FloweringBoxplot.pdf</span>
</pre>



<p>
turns into this:
</p>



<pre class="src src-org"><span class="org-org-meta-line">#+results: BoxplotFlowering</span>
<span class="org-org-link">file:FloweringBoxplot.pdf</span>
<span class="org-org-meta-line">#+ATTR_LaTeX: width=10cm</span>
</pre>



<p>
Two questions:
</p><ol>
<li>
Is it desirable that we remove the corresponding results block
<b>anywhere</b> in the buffer, but then re-insert it beneath the code
block? Or should we promise to re-insert in situ, in the case
that we find a pre-existing results block?
</li>
<li>
How should a user use a #+ATTR<sub>LaTeX</sub> line?

</li>
</ol>

</div>

<div id="outline-container-1_1" class="outline-3">
<h3 id="sec-1_1">Solved </h3>
<div class="outline-text-3" id="text-1_1">

<p>Yes, we should certainly be updating the result "in situ".
</p>
<p>
alright, this has now been implemented, in addition I've added
<code>append</code> and <code>prepend</code> results arguments to for adding new results
either before or after existing results.  The following demonstrates
this new behavior
</p>



<pre class="src src-org"><span class="org-org-meta-line">#+results: in-situ</span>
<span class="org-org-code">: update me in place please -- Mon Jun  7 16:44:44 2010
: update me in place please -- Mon Jun  7 16:44:43 2010
: update me in place please -- Mon Jun  7 16:44:42 2010
: update me in place please -- Mon Jun  7 16:44:37 2010
: update me in place please -- Mon Jun  7 16:42:14 2010
: update me in place please (at the bottom) -- Mon Jun  7 16:44:59 2010
: update me in place please (at the bottom) -- Mon Jun  7 16:45:00 2010
: update me in place please (at the bottom) -- Mon Jun  7 16:45:02 2010
</span>
the results should be <span class="org-bold">*above*</span> the block

<span class="org-org-meta-line">#+srcname: in-situ</span>
<span class="org-org-meta-line">#+begin_src emacs-lisp :results prepend
</span><span class="org-org-block">  (format "update me in place please -- %s"
          (current-time-string))</span><span class="org-org-meta-line">
#+end_src</span>

<span class="org-org-meta-line">#+srcname: in-situ</span>
<span class="org-org-meta-line">#+begin_src emacs-lisp :results append
</span><span class="org-org-block">  (format "update me in place please (at the bottom) -- %s"
          (current-time-string))</span><span class="org-org-meta-line">
#+end_src</span>
</pre>



</div>

</div>

<div id="outline-container-1_2" class="outline-3">
<h3 id="sec-1_2">Graham Smith email </h3>
<div class="outline-text-3" id="text-1_2">




<pre class="src src-message"><span class="org-message-header-name">From:</span> <span class="org-message-header-other">Dan Davison &lt;<a href="mailto:davison&#64;stats.ox.ac.uk">davison&#64;stats.ox.ac.uk</a>&gt;</span>
<span class="org-message-header-name">Subject:</span> <span class="org-message-header-subject">Re: [Orgmode] Re: [babel] captions and figure size on export</span>
<span class="org-message-header-name">User-Agent:</span> <span class="org-message-header-other">Gnus/5.13 (Gnus v5.13) Emacs/23.1 (gnu/linux)</span>
<span class="org-message-header-name">Date:</span> <span class="org-message-header-other">Tue, 09 Mar 2010 09:32:19 -0500</span>
<span class="org-message-header-name">To:</span> <span class="org-message-header-to">Graham Smith &lt;<a href="mailto:myotisone&#64;gmail.com">myotisone&#64;gmail.com</a>&gt;</span>
<span class="org-message-header-name">Cc:</span> <span class="org-message-header-cc">emacs-orgmode@gnu.org</span>

Graham Smith &lt;<a href="mailto:myotisone&#64;gmail.com">myotisone&#64;gmail.com</a>&gt; writes:

<span class="org-message-cited-text">&gt; This is driving me mad here:  I have removed all the fig and size code</span>
<span class="org-message-cited-text">&gt; and replaced it with onky one line that should be resizing the first</span>
<span class="org-message-cited-text">&gt; graph(FloweringBoxplot.pdf).  However, its resizing the second graph</span>
<span class="org-message-cited-text">&gt; (NonFloweringBoxplot/pdf) and not affecting the first graph. This</span>
<span class="org-message-cited-text">&gt; works on other files, so I am really at a loss here.</span>

Hi Graham,

We can see what's going on here by executing the block manually with C-c
C-c, which transforms your results block from this:

#+results: BoxplotFlowering
[[file:FloweringBoxplot.pdf]]

into this:

#+results: BoxplotFlowering
[[file:FloweringBoxplot.pdf]]

(The reason is that the results block corresponding to the code block is
first deleted and then re-inserted immediately below the code block).

You are using ':exports both' which means that the above transformation
actually occurs during export, but in a special pre-export org buffer
which the user never sees. The fact that the ATTR_LaTeX line ends up
last explains why it modifies the *second* block.

Thanks for pointing this out -- we will revisit this behaviour as it
does seem surprising and on the face of it undesirable.

As a workaround, is it necessary for you to execute the block on export?
Or could you instead use :exports code? I.e. before export, execute the
block manually and ensure that the #+ATTR_LaTeX and #+results lines are
arranged in the correct way.

Dan
</pre>


</div>
</div>
</div>
