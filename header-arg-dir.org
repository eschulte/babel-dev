#+seq_todo: TODO DOESN'T_WORK | WORKS

* Test local and remote working dirs
    :PROPERTIES:
    :noweb: yes
    :END:
*** TODO :results output
    :PROPERTIES:
    :results: output
    :END:
***** WORKS :session
******* WORKS R
********* code
#+source: dir-test-R
#+begin_src R 
  date()
  system("hostname")
  getwd()
#+end_src

********* WORKS local
#+begin_src R :session R-local :dir /tmp
<<dir-test-R>>
#+end_src

#+results:
: [1] "Wed Feb 17 15:28:27 2010"
: Luscinia
: [1] "/tmp"
      
********* WORKS remote
#+begin_src R :session R-remote :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-R>>
#+end_src

#+results:
: [1] "Wed Feb 17 20:28:21 2010"
: oak
: [1] "/data/oak/user/davison/bench"

******* WORKS ruby
********* code
#+source: dir-test-ruby
#+begin_src ruby
system("date")
system("hostname")
system("pwd")
#+end_src

********* WORKS local
#+begin_src ruby :session ruby-local :dir /tmp
<<dir-test-ruby>>
#+end_src

#+results:
: Fri Feb 19 12:09:32 EST 2010
: true
: Luscinia
: true
: /tmp
: true

********* WORKS remote
#+begin_src ruby :session ruby-remote :dir /yakuba:/tmp
<<dir-test-ruby>>
#+end_src

#+results:
: 
: Fri Feb 19 12:08:50 EST 2010
: true
: yakuba.princeton.edu
: true
: /tmp
: true
******* WORKS python
********* code
#+source: dir-test-python
#+begin_src python
  import os, time
  print time.ctime()
  print os.uname()
  print os.getcwd()
  print '\n' ## We have a bug involving losing final lines
#+end_src

********* WORKS local
#+begin_src python :session python-local :dir /home/dan/
<<dir-test-python>>
#+end_src

#+results:
: Wed Feb 17 15:29:27 2010
: Linux', 'Luscinia', '2.6.31-19-generic', '#56-Ubuntu SMP Thu Jan 28 01:26:53 UTC 2010', 'i686
: /home/dan
********* WORKS remote

#+begin_src python :session python-remote :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-python>>
#+end_src

#+results:
: Wed Feb 17 20:29:42 2010
: Linux', 'oak', '2.6.28-15-server', '#52-Ubuntu SMP Wed Sep 9 11:34:09 UTC 2009', 'x86_64
: /data/oak/user/davison/bench

******* WORKS shell
********* code
#+source: dir-test-shell
#+begin_src sh
  date
  hostname
  pwd
#+end_src

********* WORKS local
#+begin_src sh :session sh-local :dir /tmp
<<dir-test-shell>>
#+end_src

#+results:
: Wed Feb 17 15:29:08 EST 2010
: Luscinia
: /tmp
********* WORKS remote
#+begin_src sh :session sh-remote :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-shell>>
#+end_src

#+results:
: Wed Feb 17 20:29:17 GMT 2010
: oak
: /home/davison/bench
***** TODO non-session
      The remaining task here is to get shell-command-on-region to run
      remotely.
******* TODO R
********* WORKS local
#+begin_src R :dir /home/dan
<<dir-test-R>>
#+end_src

#+results:
: [1] "Wed Feb 17 15:58:06 2010"
: Luscinia
: [1] "/home/dan/Work"
********* DOESN'T_WORK remote
	Does not run remotely
#+begin_src R :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-R>>
#+end_src

#+results:
: [1] "Wed Feb 17 15:58:18 2010"
: Luscinia
: [1] "/home/dan"

******* TODO ruby
********* WORKS local
#+begin_src ruby :dir /home/dan
<<dir-test-ruby>>
#+end_src

#+results:
: Wed Feb 17 15:58:50 EST 2010
: Luscinia
: /home/dan
********* DOESN'T_WORK remote
#+begin_src ruby :dir /yakuba:
<<dir-test-ruby>>
#+end_src

#+results:
: Wed Feb 17 15:59:00 EST 2010
: Luscinia
: /home/dan
******* TODO python
********* WORKS local
#+begin_src python :dir /home/dan/
<<dir-test-python>>
#+end_src

#+results:
: Wed Feb 17 15:59:29 2010
: ('Linux', 'Luscinia', '2.6.31-19-generic', '#56-Ubuntu SMP Thu Jan 28 01:26:53 UTC 2010', 'i686')
: /home/dan
: 
: 
********* DOESN'T_WORK remote
#+begin_src python :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-python>>
#+end_src

#+results:
: Wed Feb 17 15:59:49 2010
: ('Linux', 'Luscinia', '2.6.31-19-generic', '#56-Ubuntu SMP Thu Jan 28 01:26:53 UTC 2010', 'i686')
: /home/dan
: 
: 
******* TODO shell
********* WORKS local
#+begin_src sh :dir /tmp
<<dir-test-shell>>
#+end_src

#+results:
: Wed Feb 17 15:59:08 EST 2010
: Luscinia
: /tmp
********* DOESN'T_WORK remote
#+begin_src sh :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-shell>>
#+end_src

#+results:
: Wed Feb 17 15:59:18 EST 2010
: Luscinia
: /home/dan
*** :results value
    :PROPERTIES:
    :results: value
    :END:
***** TODO :session
******* TODO R
********* code
#+source: dir-test-R-value
#+begin_src R 
c(system("hostname", intern=TRUE), getwd())
#+end_src

********* WORKS local
#+begin_src R :session R-local :dir /tmp
<<dir-test-R-value>>
#+end_src

#+results:
| Luscinia |
| /tmp     |
      
********* DOESN'T_WORK remote
	  The data is written remotely, but currently we attempt to read it locally.
#+begin_src R :session R-remote :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-R-value>>
#+end_src
******* WORKS ruby
********* code
#+source: dir-test-ruby-value
#+begin_src ruby
[1, 2]
#+end_src

********* WORKS local
#+begin_src ruby :session ruby-local :dir /tmp
<<dir-test-ruby-value>>
#+end_src

#+results:
| 1 | 2 |
********* WORKS remote
	  This works because results are not transferred via file for ruby :session :results value

#+begin_src ruby :session ruby-remote :dir /yakuba:
<<dir-test-ruby-value>>
#+end_src

#+results:
| 1 | 2 |

******* WORKS python
********* code
#+source: dir-test-python-value
#+begin_src python
  import os, time
  [time.ctime(), os.uname(),os.getcwd()]
#+end_src

********* WORKS local
#+begin_src python :session python-local :dir /tmp
<<dir-test-python-value>>
#+end_src

#+results:
| Fri Feb 19 11:53:11 2010 | (Linux Luscinia 2.6.31-19-generic #56-Ubuntu SMP Thu Jan 28 01:26:53 UTC 2010 i686) | /tmp |
********* WORKS remote
	  This works because results are not transferred via file for python :session :results value

#+begin_src python :session python-remote :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-python-value>>
#+end_src

#+results:
| Fri Feb 19 16:53:40 2010 | (Linux oak 2.6.28-15-server #52-Ubuntu SMP Wed Sep 9 11:34:09 UTC 2009 x86_64) | /data/oak/user/davison/bench |
******* shell
********* code
#+source: dir-test-shell-value
#+begin_src sh
echo hello
echo `hostname`
echo `pwd`
echo goodbye
echo `pwd`
echo `hostname`
#+end_src

********* WORKS local
	  But Looks like a shell ':session :results value' bug here.
#+begin_src sh :session sh-local :dir /tmp :results vector
<<dir-test-shell-value>>
#+end_src

#+results:
| Luscinia |
********* WORKS remote
#+begin_src sh :session sh-remote :dir /davison@oak.well.ox.ac.uk:bench :results vector
<<dir-test-shell-value>>
#+end_src

#+results:
| /home/davison/bench |

***** non-session
******* R
********* WORKS local
#+begin_src R :dir /home/dan
<<dir-test-R>>
#+end_src

#+results:
: [1] "Wed Feb 17 15:58:06 2010"
: Luscinia
: [1] "/home/dan/Work"
********* DOESN'T_WORK remote
	Does not run remotely
#+begin_src R :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-R>>
#+end_src

#+results:
: [1] "Wed Feb 17 15:58:18 2010"
: Luscinia
: [1] "/home/dan"

******* ruby
********* WORKS local
#+begin_src ruby :dir /home/dan
<<dir-test-ruby>>
#+end_src

#+results:
: Wed Feb 17 15:58:50 EST 2010
: Luscinia
: /home/dan
********* DOESN'T_WORK remote
#+begin_src ruby :dir /yakuba:
<<dir-test-ruby>>
#+end_src

#+results:
: Wed Feb 17 15:59:00 EST 2010
: Luscinia
: /home/dan
******* shell
********* WORKS local
#+begin_src sh :dir /tmp
<<dir-test-shell>>
#+end_src

#+results:
: Wed Feb 17 15:59:08 EST 2010
: Luscinia
: /tmp
********* DOESN'T_WORK remote
#+begin_src sh :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-shell>>
#+end_src

#+results:
: Wed Feb 17 15:59:18 EST 2010
: Luscinia
: /home/dan
******* python
********* WORKS local
#+begin_src python :dir /home/dan/
<<dir-test-python>>
#+end_src

#+results:
: Wed Feb 17 15:59:29 2010
: ('Linux', 'Luscinia', '2.6.31-19-generic', '#56-Ubuntu SMP Thu Jan 28 01:26:53 UTC 2010', 'i686')
: /home/dan
: 
: 
********* DOESN'T_WORK remote
#+begin_src python :dir /davison@oak.well.ox.ac.uk:bench
<<dir-test-python>>
#+end_src

#+results:
: Wed Feb 17 15:59:49 2010
: ('Linux', 'Luscinia', '2.6.31-19-generic', '#56-Ubuntu SMP Thu Jan 28 01:26:53 UTC 2010', 'i686')
: /home/dan
: 
: 

* Test file output dir
*** TODO ditaa
    Output file path is relative to :dir, but link is not.
#+begin_src ditaa :file ditaa-org-babel.png :cmdline -r :dir /tmp
+-----------+
| cBLU      |
| Org       |
|    +------+
|    |cPNK  |
|    |babel |
|    |      |
+----+------+
#+end_src

#+results:
[[file:ditaa-org-babel.png]]



* results value implementation

Are results transferred to elisp via file?

| language | session | non-session |
|----------+---------+-------------|
| R        | yes     | yes         |
| ruby     | no      | yes         |
| python   | no      | yes         |
| shell    | yes*    | NA          |
| haskell  | no      | NA          |

Ought we to consider not using files for ruby-non-session and
python-non-session?
